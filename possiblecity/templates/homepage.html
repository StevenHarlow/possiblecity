{% extends "base.html" %}

{% block head_title_site %}Welcome to the Possible City{% endblock head_title_site %}

{% block body_class %}home{% endblock %}
{% block extra_head %}
<!-- Leaflet -->
{% load staticfiles %}
<link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %}" />
<!--[if lte IE 8]><link rel="stylesheet" href="{% static 'leaflet/leaflet.ie.css' %}" /><![endif]-->
<script src="{% static 'leaflet/leaflet.js' %}"></script>
{% endblock extra_head %}
{% block layout %}
    <div id="map" style="height: 20em"></div>
    <h1>Welcome to Possible City</h1>
    
    {% if user.is_authenticated %}
        {% url what_next as what_next_url %}
        <p class="what_next">Wondering <a href="{{ 
what_next_url }}" class="btn primary large">What Next</a>?</p>
    {% else %}
        {% url account_login as login_url %}
        {% url account_signup as signup_url %}
        <p>You can <a href="{{ login_url }}" 
class="btn">Log In</a> or <a href="{{ signup_url }}" class="btn 
primary">Sign Up</a> to try out the site.</p>
    {% endif %}
{% endblock layout %}
{% block js_local %}
<script>
    var map = new L.Map('map', {
         zoomControl: false
    });
    var cloudmade = new L.TileLayer('http://{s}.tile.cloudmade.com/17de60efa2c548c2b8b8bb215db49cb4/47928/256/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy;',
    });
    var philadelphia = new L.LatLng(39.9522, -75.1642);
    map.addLayer(cloudmade);
    
    var dataStyle = {
        "fillColor": "#ff0000",
        "opacity": 1.0,
        "weight": 1,
        "color":"#000000",
    };

    var dataLayer = L.geoJson(null, {
        style: dataStyle
    }).addTo(map);
    
    $.getJSON('{% url lotxlot %}', function(data){
          dataLayer.addData(data);
          bounds = dataLayer.getBounds();
          map.fitBounds(bounds);
    });
</script>
{% endblock js_local %}